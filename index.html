<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ูุณุงุจูุฉ ุงููุนูููุงุช ุงูุชุฑููููุฉ</title>
<!-- ุฌูุจ ุฎุท Cairo ูุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
<!-- ุฑุจุท ููู ุงูุชูุณููุงุช ุงูุฎุงุฑุฌู -->
<link rel="stylesheet" href="styles.css">
<!-- ุฌูุจ ููุชุจุฉ Supabase ููุชุนุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="theme-dark">
<header class="app-header">
  <div class="brand">ูุณุงุจูุฉ ุงููุนูููุงุช ๐ง</div>
  <div class="header-actions">
    <!-- ุฒุฑ ุชุจุฏูู ุงููุถุน (ูุธูู/ูุงุชุญ) -->
    <button id="themeToggle" class="icon-btn" title="ุชุจุฏูู ุงููุถุน">๐</button>
    <!-- ุฒุฑ ุงูุงูุชูุงู ูููุญุฉ ุงูุตุฏุงุฑุฉ -->
    <button id="gotoLeaderboard" class="ghost-btn">ููุญุฉ ุงูุตุฏุงุฑุฉ ๐</button>
  </div>
</header>

<main id="app">

  <!-- ุดุงุดุฉ ุงูุชุญููู (Loader) - ูููู ุฃู ุชููู ุฃูู ุดุงุดุฉ ูุจู ุชููุฆุฉ ุงูุญุงูุฉ -->
  <section id="screen-loader" class="screen active">
      <div class="card center" style="padding: 50px;">
          <h1>ุฌุงุฑู ุงูุชุญููู...</h1>
          <p class="muted">ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ ููููุงู</p>
      </div>
  </section>

  <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
  <section id="screen-start" class="screen">
    <div class="card center">
      <h1>ูุฑุญุจูุง ุจู ๐</h1>
      <p class="muted">ุงุฎุชุจุฑ ูุนูููุงุชู ูู ูุณุงุจูุฉ ููุชุนุฉ ูุณุฑูุนุฉ</p>
      <div class="stack gap-3">
        <button id="startBtn" class="primary">ุงุจุฏุฃ ุงููุนุจ</button>
        <!-- ุฒุฑ ูุชุญ ูุถุน ุงููุทููุฑ -->
        <button id="openDevBtn" class="secondary">ูุถุน ุงููุทููุฑ โ๏ธ</button>
      </div>
    </div>
  </section>

  <!-- ุงุฎุชูุงุฑ ุงูุตูุฑุฉ ุงูุฑูุฒูุฉ -->
  <section id="screen-avatar" class="screen">
    <div class="card">
      <h2>ุงุฎุชุฑ ุตูุฑุชู ุงูุฑูุฒูุฉ</h2>
      <div id="avatarGrid" class="avatar-grid"></div>
      <div class="stack mt-4 gap-3">
        <button id="avatarNextBtn" class="primary" disabled>ุงูุชุงูู</button>
        <button data-back="start" class="secondary back-btn">ุฑุฌูุน</button>
      </div>
    </div>
  </section>

  <!-- ุฅุฏุฎุงู ุงูุงุณู -->
  <section id="screen-name" class="screen">
    <div class="card">
      <h2>ุงุฏุฎู ุงุณูู</h2>
      <input id="playerNameInput" class="text-input" placeholder="ูุซุงู: ุนุจุฏ ุงููู" maxlength="25"/>
      <div class="hint">ุจูู 2 ู 25 ุญุฑููุงุ ุณููุณุชุฎุฏู ูู ููุญุฉ ุงูุตุฏุงุฑุฉ</div>
      <div class="stack mt-4 gap-3">
        <button id="confirmNameBtn" class="primary" disabled>ุชุฃููุฏ ุงูุงุณู</button>
        <button data-back="avatar" class="secondary back-btn">ุฑุฌูุน</button>
      </div>
    </div>
  </section>

  <!-- ุงูุชุนูููุงุช -->
  <section id="screen-instructions" class="screen">
    <div class="card">
      <h2>ุชุนูููุงุช ุงููุนุจุฉ ๐</h2>
      <ul class="bullets">
        <li>โ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ: <b>+100 ููุทุฉ</b> | โ ุงูุฅุฌุงุจุฉ ุงูุฎุงุทุฆุฉ: <b>-50 ููุทุฉ</b></li>
        <li>๐ ููุงูุฃุฉ ุงูุณุฑุนุฉ: <b>+50 ููุทุฉ</b> ุฅุฐุง ุฃุฌุจุช ูุจู ูุตู ุงูููุช (15 ุซุงููุฉ).</li>
        <li>โฑ ุงููุคูุช: ูุฏูู <b>30 ุซุงููุฉ</b> ููู ุณุคุงูุ ูุงูุชูุงุก ุงูููุช ููุนุชุจุฑ ุฎุทุฃ.</li>
        <li>๐ซ ุงูุฃุฎุทุงุก ุงููุณููุญ ุจูุง: <b>3 ุฃุฎุทุงุก</b> ููู ุฌููุฉ.</li>
        <li>๐ฏ ุนุฏุฏ ุงูุฃุณุฆูุฉ ุงูุฅุฌูุงูู: <b>31 ุณุคุงููุง</b> (10 ุณููุ 10 ูุชูุณุทุ 10 ุตุนุจุ 1 ูุณุชุญูู).</li>
        <li>๐ ููุงูุฉ ูู ูุณุชูู: ุงุฎุชุฑ <b>"ุงููุณุชูู ุงูุชุงูู"</b> ุฃู <b>"ุงูุงูุณุญุงุจ"</b>.</li>
      </ul>
      <div class="stack mt-4 gap-3">
        <button id="startRoundBtn" class="primary">ุจุฏุก ุงูุฌููุฉ</button>
        <button data-back="name" class="secondary back-btn">ุฑุฌูุน</button>
      </div>
    </div>
  </section>

  <!-- ุงุฎุชูุงุฑ ุงููุณุชูู (ูุถุน ุงููุทููุฑ ููุท) -->
  <section id="screen-level-select" class="screen">
    <div class="card">
      <h2>ุงุฎุชูุงุฑ ุงููุณุชูู (ูุถุน ุงููุทููุฑ ููุท)</h2>
      <p class="muted">ุชุฌุงูุฒ ุงูุชุณูุณู ูุงุจุฏุฃ ูู ุฃู ูุณุชูู.</p>
      <div class="pill-row" id="devLevelSelect">
        <button class="pill" data-level="easy">ุณูู (1)</button>
        <button class="pill" data-level="medium">ูุชูุณุท (2)</button>
        <button class="pill" data-level="hard">ุตุนุจ (3)</button>
        <button class="pill" data-level="impossible">ูุณุชุญูู (4)</button>
      </div>
      <div class="stack mt-4">
        <button data-back="start" class="secondary back-btn">ุงูุนูุฏุฉ ููุจุฏุงูุฉ</button>
      </div>
    </div>
  </section>

  <!-- ุดุงุดุฉ ุงููุนุจ -->
  <section id="screen-game" class="screen">
    <div class="hud">
      <div class="level-dots" id="levelDots"></div>
      <div class="hud-right">
        <div class="chip" id="hudScore">ุงูููุงุท: 0</div>
        <div class="chip" id="hudMistakes">ุงูุฃุฎุทุงุก: 0/3</div>
        <div class="chip avatar-chip"><span id="hudAvatar">๐</span><span id="hudName">โ</span></div>
      </div>
    </div>

    <!-- ุดุฑูุท ุงููุณุงุนุฏุงุช -->
    <div class="helpers">
      <button id="btnFifty" class="helper" title="ููุญุฐู ุฎูุงุฑุงู ุฎุงุทุฆุงู - ูุฑุฉ ูุงุญุฏุฉ ููุท">๐ 50:50</button>
      <button id="btnFreeze" class="helper" title="ูููู ุงููุคูุช 10 ุซูุงูู - ูุฑุฉ ูุงุญุฏุฉ ููุท">โ๏ธ ุชุฌููุฏ <small>10ุซ</small></button>
      <button id="btnSkip" class="helper" title="ุชุฎุทู ุงูุณุคุงู - ุบูุฑ ูุญุฏูุฏ">โญ ุชุฎุทู <small id="skipCost">(20)</small></button>
    </div>

    <!-- ุดุฑูุท ุงููุคูุช -->
    <div class="timer">
      <div id="timerBar" class="timer-bar"></div>
      <div id="timerLabel" class="timer-label">30</div>
    </div>

    <div class="card question-card">
      <div class="level-badge" id="levelBadge" data-level="easy">ุณูู</div>
      <div id="qCounter" class="muted">ุงูุณุคุงู 1 ูู 10</div>
      <h3 id="questionText">...</h3>
      <div id="options" class="options">
        <!-- ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ ุณุชูุนุฑุถ ููุง -->
      </div>
    </div>
  </section>

  <!-- ููุงูุฉ ุงููุณุชูู -->
  <section id="screen-level-end" class="screen">
    <div class="card center">
      <h2>ุชูุงูููุง! ุงูุชูู ุงููุณุชูู <span id="currentLevelEndBadge" class="level-badge" data-level="easy"></span> ๐ฏ</h2>
      <p>ุงุฎุชุฑ ูุง ุชุฑูุฏ ูุนูู ุงูุขู:</p>
      <div class="stack mt-4 gap-3">
        <button id="btnNextLevel" class="primary">ุงููุณุชูู ุงูุชุงูู</button>
        <button id="btnWithdraw" class="ghost-btn">ุงูุงูุณุญุงุจ ูุนุฑุถ ุงููุชุงุฆุฌ</button>
      </div>
    </div>
  </section>

  <!-- ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ -->
  <section id="screen-results" class="screen">
    <div class="card">
      <h2>๐ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ๐</h2>
      <div class="result-grid" id="finalResults"></div>

      <div class="share-box">
        <h3>ูุดุงุฑูุฉ ุงููุชุงุฆุฌ ๐ข</h3>
        <textarea id="shareText" class="share-text" readonly></textarea>
        <div class="stack mt-3 row gap-3">
          <button id="shareXBtn" class="primary" style="flex-grow: 1;">ุงูุดุฑ ุนูู ๐</button>
          <button id="copyShareTextBtn" class="secondary" style="flex-grow: 1;">ุงูุณุฎ ุงููุต</button>
        </div>
      </div>

      <div class="stack mt-4 gap-3">
        <button id="playAgainBtn" class="primary">ูุนุจ ูุฑุฉ ุฃุฎุฑู</button>
        <button id="openLeaderboardBtn" class="secondary">ููุญุฉ ุงูุตุฏุงุฑุฉ</button>
      </div>
    </div>
  </section>

  <!-- ููุญุฉ ุงูุตุฏุงุฑุฉ -->
  <section id="screen-leaderboard" class="screen">
    <div class="card">
      <h2>ููุญุฉ ุงูุตุฏุงุฑุฉ ๐</h2>
      <p class="muted">ูุชู ุชุญุฏูุซ ุงููุงุฆูุฉ ูู ุฏูููุฉ (Polling).</p>
      <div class="pill-row" id="lbFilters">
        <button class="pill active" data-filter="all">ุงููู</button>
        <button class="pill" data-filter="top10">ุฃูุถู 10</button>
        <button class="pill" data-filter="impossible">ูุชุฎุทูู ุงููุณุชุญูู</button>
      </div>
      <div id="leaderboardList" class="list"></div>
      <div class="stack mt-4">
        <button data-back="start" class="secondary back-btn">ุงูุนูุฏุฉ ููุจุฏุงูุฉ</button>
      </div>
    </div>
  </section>

  <!-- ููุงูุฐ ููุจุซูุฉ (Modals) -->

  <!-- 1. ูุงูุฐุฉ ุชูุงุตูู ุงููุงุนุจ (ุชุธูุฑ ุนูุฏ ุงูุถุบุท ุนูู ุงุณู ูู ุงูุตุฏุงุฑุฉ) -->
  <div id="playerDetailsModal" class="modal hidden">
    <div class="modal-content">
      <button class="modal-close" id="closePlayerModal" title="ุฅุบูุงู">ร</button>
      <h3>ุชูุงุตูู ูุชุงุฆุฌ ุงููุงุนุจ</h3>
      <div id="playerDetailsBody" class="list thin">
        <!-- ุณุฌูุงุช ูุชุงุฆุฌ ุงููุงุนุจ ุณุชูุนุฑุถ ููุง -->
      </div>
    </div>
  </div>

  <!-- 2. ูุงูุฐุฉ ุงูุฅุจูุงุบ ุนู ูุดููุฉ (ุชููุชุญ ุนุจุฑ ุฒุฑ FAB) -->
  <div id="reportModal" class="modal hidden">
    <div class="modal-content">
      <button class="modal-close" id="closeReport" title="ุฅุบูุงู">ร</button>
      <h3>ุฅุจูุงุบ ุนู ูุดููุฉ ๐๏ธ</h3>
      <p class="muted">ุณูุชู ุฅุฑุณุงู ุจูุงุบู ุจุดูู ุณุฑู ุฅูู ูุฑูู ุงูุฅุดุฑุงู.</p>

      <label class="label">ููุน ุงููุดููุฉ</label>
      <select id="reportType" class="text-input">
        <option>ุณุคุงู ุบูุฑ ูุงุถุญ</option>
        <option>ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ</option>
        <option>ุฎุทุฃ ุชููู</option>
        <option>ูุดููุฉ ูู ุงููุคูุช</option>
        <option>ูุดููุฉ ุนุฑุถ/ูุบุฉ</option>
      </select>
      
      <label class="label">ุงููุตู</label>
      <textarea id="reportDesc" class="text-area" rows="3" placeholder="ุงุดุฑุญ ุงููุดููุฉ ุจุฅูุฌุงุฒ ููุถูุญ"></textarea>
      
      <label class="label">ุตูุฑุฉ ูุฑููุฉ (ุงุฎุชูุงุฑู)</label>
      <input id="reportImage" type="file" accept="image/*"/>
      
      <div class="row mt-3"><label><input type="checkbox" id="reportAuto" checked/> ุฅุฑุณุงู ุจูุงูุงุช ุงูุฌูุงุฒ ูุงูุณุคุงู ุชููุงุฆููุง</label></div>
      
      <div class="stack mt-3">
        <button id="sendReportBtn" class="primary">ุฅุฑุณุงู ุงูุจูุงุบ</button>
      </div>
    </div>
  </div>

</main>

<footer class="app-footer">
  <!-- ุฒุฑ ุงูุฅุจูุงุบ ุงูุนุงุฆู (FAB) -->
  <button id="openReportBtn" class="fab" title="ุฅุจูุงุบ ุนู ูุดููุฉ">โ๏ธ</button>
</footer>

<!-- ุฑุจุท ููู ุฌุงูุงุณูุฑูุจุช ูููุธุงุฆู -->
<script src="script.js"></script>
</body>
</html>

