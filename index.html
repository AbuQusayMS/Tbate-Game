<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ูุณุงุจูุฉ ุงููุนูููุงุช</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css" />
  <!-- Supabase SDK (ุงุฎุชูุงุฑู ูููุญุฉ ุงูุตุฏุงุฑุฉ) -->
  <script defer src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="theme-dark">
  <header class="app-header">
    <div class="brand">ูุณุงุจูุฉ ุงููุนูููุงุช ๐ง</div>
    <div class="header-actions">
      <button id="themeToggle" class="icon-btn" title="ุชุจุฏูู ุงููุถุน">๐</button>
      <button id="gotoLeaderboard" class="ghost-btn">ููุญุฉ ุงูุตุฏุงุฑุฉ ๐</button>
    </div>
  </header>

  <main id="app">

    <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
    <section id="screen-start" class="screen active">
      <div class="card center">
        <h1>ูุฑุญุจูุง ุจู ๐</h1>
        <p class="muted">ุงุฎุชุจุฑ ูุนูููุงุชู ูู ูุณุงุจูุฉ ููุชุนุฉ ูุณุฑูุนุฉ</p>
        <div class="stack gap-3">
          <button id="startBtn" class="primary">ุงุจุฏุฃ ุงููุนุจ</button>
          <button id="openDevBtn" class="ghost-btn">ูุถุน ุงููุทููุฑ</button>
        </div>
      </div>
    </section>

    <!-- ุงุฎุชูุงุฑ ุงูุตูุฑุฉ ุงูุฑูุฒูุฉ -->
    <section id="screen-avatar" class="screen">
      <div class="card">
        <h2>ุงุฎุชุฑ ุตูุฑุชู ุงูุฑูุฒูุฉ</h2>
        <div id="avatarGrid" class="avatar-grid"></div>
        <div class="stack mt-4">
          <button id="avatarNextBtn" class="primary" disabled>ุงูุชุงูู</button>
          <button data-back="#screen-start" class="secondary back-btn">ุฑุฌูุน</button>
        </div>
      </div>
    </section>

    <!-- ุฅุฏุฎุงู ุงูุงุณู -->
    <section id="screen-name" class="screen">
      <div class="card">
        <h2>ุงุฏุฎู ุงุณูู</h2>
        <input id="playerNameInput" class="text-input" placeholder="ูุซุงู: ุนุจุฏ ุงููู" maxlength="25" />
        <div class="hint">ุจูู 2 ู 25 ุญุฑููุง</div>
        <div class="stack mt-4">
          <button id="confirmNameBtn" class="primary" disabled>ุชุฃููุฏ ุงูุงุณู</button>
          <button data-back="#screen-avatar" class="secondary back-btn">ุฑุฌูุน</button>
        </div>
      </div>
    </section>

    <!-- ุงูุชุนูููุงุช -->
    <section id="screen-instructions" class="screen">
      <div class="card">
        <h2>ุชุนูููุงุช ุงููุนุจุฉ ๐</h2>
        <ul class="bullets">
          <li>ุงูููุงุท: ุตุญูุญุฉ +100 | ุฎุงุทุฆุฉ -50 | ููุงูุฃุฉ ุงูุณุฑุนุฉ +50</li>
          <li>ุงูููุช: 30 ุซุงููุฉ ููู ุณุคุงู</li>
          <li>ุงููุณุงุนุฏุงุช: 50:50 (ูุฑุฉ/ุฌููุฉ) | ุงูุชุฌููุฏ 10ุซ (ูุฑุฉ/ุฌููุฉ) | ุงูุชุฎุทู ุบูุฑ ูุญุฏูุฏ (20 ููุทุฉ ูุชุฒุฏุงุฏ 20 ูุน ูู ุงุณุชุฎุฏุงู)</li>
          <li>ุงูุฃุฎุทุงุก: ูุณููุญ 3 ููุท</li>
          <li>ุงููุณุชููุงุช (31 ุณุคุงู): 10 ุณููุ 10 ูุชูุณุทุ 10 ุตุนุจุ 1 ูุณุชุญูู</li>
          <li>ููุงูุฉ ูู ูุณุชูู: ุงูุชุงูู / ุงูุงูุณุญุงุจ ูุนุฑุถ ุงููุชุงุฆุฌ</li>
        </ul>
        <div class="stack mt-4">
          <button id="startRoundBtn" class="primary">ุจุฏุก ุงูุฌููุฉ</button>
          <button data-back="#screen-name" class="secondary back-btn">ุฑุฌูุน</button>
        </div>
      </div>
    </section>

    <!-- ุงุฎุชูุงุฑ ุงููุณุชูู (ูููุทููุฑ ููุท) -->
    <section id="screen-level-select" class="screen">
      <div class="card">
        <h2>ุงุฎุชูุงุฑ ุงููุณุชูู (ูุถุน ุงููุทููุฑ ููุท)</h2>
        <div class="pill-row">
          <button class="pill" data-level="easy">ุณูู</button>
          <button class="pill" data-level="medium">ูุชูุณุท</button>
          <button class="pill" data-level="hard">ุตุนุจ</button>
          <button class="pill" data-level="impossible">ูุณุชุญูู</button>
        </div>
        <div class="stack mt-4">
          <button data-back="#screen-instructions" class="secondary back-btn">ุฑุฌูุน</button>
        </div>
      </div>
    </section>

    <!-- ุดุงุดุฉ ุงููุนุจ -->
    <section id="screen-game" class="screen">
      <div class="hud">
        <div class="level-dots" id="levelDots"></div>
        <div class="hud-right">
          <div class="chip" id="hudScore">ุงูููุงุท: 0</div>
          <div class="chip" id="hudMistakes">ุงูุฃุฎุทุงุก: 0/3</div>
          <div class="chip avatar-chip"><span id="hudAvatar">๐</span><span id="hudName">โ</span></div>
        </div>
      </div>

      <div class="helpers">
        <button id="btnSkip" class="helper">
          ุชุฎุทู <small id="skipCost">(20)</small>
        </button>
        <button id="btnFreeze" class="helper">
          โ๏ธ ุชุฌููุฏ <small>10ุซ</small>
        </button>
        <button id="btnFifty" class="helper">
          50:50
        </button>
      </div>

      <div class="timer">
        <div id="timerBar" class="timer-bar"></div>
        <div id="timerLabel" class="timer-label">30</div>
      </div>

      <div class="card question-card">
        <div class="level-badge" id="levelBadge">ุณูู</div>
        <div id="qCounter" class="muted">ุงูุณุคุงู 1 ูู 10</div>
        <h3 id="questionText">...</h3>
        <div id="options" class="options"></div>
      </div>
    </section>

    <!-- ูุงูุฐุฉ ููุงูุฉ ุงููุณุชูู -->
    <section id="screen-level-end" class="screen">
      <div class="card center">
        <h2>ุงูุชูู ุงููุณุชูู ๐ฏ</h2>
        <div class="stack mt-4">
          <button id="btnNextLevel" class="primary">ุงููุณุชูู ุงูุชุงูู</button>
          <button id="btnWithdraw" class="ghost-btn">ุงูุงูุณุญุงุจ ูุนุฑุถ ุงููุชุงุฆุฌ</button>
        </div>
      </div>
    </section>

    <!-- ุดุงุดุฉ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ -->
    <section id="screen-results" class="screen">
      <div class="card">
        <h2>๐ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ๐</h2>
        <div class="result-grid" id="finalResults">
          <!-- ุณูุชู ุงูุชุนุจุฆุฉ ุฏููุงูููููุง -->
        </div>

        <div class="share-box">
          <h3>ูุดุงุฑูุฉ ุงููุชุงุฆุฌ ๐ข</h3>
          <div class="stack">
            <button id="shareXBtn" class="primary">ุงูุดุฑ ุนูู ๐</button>
            <button id="copyShareTextBtn" class="secondary">ุงูุณุฎ ุงููุต</button>
          </div>
          <textarea id="shareText" class="share-text" readonly></textarea>
        </div>

        <div class="stack mt-4">
          <button id="playAgainBtn" class="primary">ูุนุจ ูุฑุฉ ุฃุฎุฑู</button>
          <button id="openLeaderboardBtn" class="ghost-btn">ููุญุฉ ุงูุตุฏุงุฑุฉ</button>
        </div>
      </div>
    </section>

    <!-- ููุญุฉ ุงูุตุฏุงุฑุฉ -->
    <section id="screen-leaderboard" class="screen">
      <div class="card">
        <h2>ููุญุฉ ุงูุตุฏุงุฑุฉ ๐</h2>
        <div class="pill-row" id="lbFilters">
          <button class="pill active" data-filter="all">ุงููู</button>
          <button class="pill" data-filter="top10">ุฃูุถู 10</button>
          <button class="pill" data-filter="impossible">ูุชุฎุทูู ุงููุณุชุญูู</button>
        </div>
        <div id="leaderboardList" class="list"></div>
        <div class="stack mt-4">
          <button data-back="#screen-start" class="secondary back-btn">ุงูุนูุฏุฉ</button>
        </div>
      </div>
    </section>

    <!-- ูุงูุฐุฉ ุชูุงุตูู ุงููุงุนุจ (ูู ุงูุตุฏุงุฑุฉ) -->
    <div id="playerDetailsModal" class="modal hidden">
      <div class="modal-content">
        <button class="modal-close" id="closePlayerModal">ร</button>
        <h3>ุชูุงุตูู ูุชุงุฆุฌ ุงููุงุนุจ</h3>
        <div id="playerDetailsBody" class="list thin"></div>
      </div>
    </div>

    <!-- ูุงูุฐุฉ ุงูุจูุงุบุงุช -->
    <div id="reportModal" class="modal hidden">
      <div class="modal-content">
        <button class="modal-close" id="closeReport">ร</button>
        <h3>ุฅุจูุงุบ ุนู ูุดููุฉ ๐๏ธ</h3>
        <label class="label">ููุน ุงููุดููุฉ</label>
        <select id="reportType" class="text-input">
          <option>ุณุคุงู ุบูุฑ ูุงุถุญ</option>
          <option>ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ</option>
          <option>ุฎุทุฃ ุชููู</option>
          <option>ูุดููุฉ ูู ุงููุคูุช</option>
          <option>ูุดููุฉ ุนุฑุถ/ูุบุฉ</option>
        </select>
        <label class="label">ุงููุตู</label>
        <textarea id="reportDesc" class="text-area" rows="3" placeholder="ุงุดุฑุญ ุงููุดููุฉ ุจุฅูุฌุงุฒ"></textarea>
        <label class="label">ุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
        <input id="reportImage" type="file" accept="image/*" />
        <div class="row">
          <label><input type="checkbox" id="reportAuto" checked /> ุงูุชุดุงู ุชููุงุฆู (ููุน ุงููุชุตูุญ/ุงูุดุงุดุฉ/ุงูุณุคุงู ุงูุญุงูู)</label>
        </div>
        <div class="stack mt-3">
          <button id="sendReportBtn" class="primary">ุฅุฑุณุงู ุงูุจูุงุบ</button>
        </div>
      </div>
    </div>

  </main>

  <footer class="app-footer">
    <button id="openReportBtn" class="fab" title="ุฅุจูุงุบ">โ๏ธ</button>
  </footer>

  <script src="./script.js"></script>
</body>
</html>
