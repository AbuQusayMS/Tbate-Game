<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="description" content="ğŸ§  Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª - Ø§Ø®ØªØ¨Ø± Ù‚Ø¯Ø±Ø§ØªÙƒ ÙÙŠ Ù…Ø³Ø§Ø¨Ù‚Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù…Ù„ÙŠØ¦Ø© Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª">
  <title>ğŸ§  Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</title>
  <link rel="icon" type="image/png" href="/images/my-icon.png">
  
  <style>
    /* ==============================
      Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© (Variables + Reset)
    ============================== */
    :root {
      --font-main: 'Cairo', sans-serif;
      /* Ø£Ù„ÙˆØ§Ù† Ø¹Ø§Ù…Ø© */
      --color-dark: #121212;
      --color-light: #ffffff;
      --color-gray: #888;
      --color-border: #ddd;
      /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª */
      --easy-bg: #e8f5e9;
      --easy-text: #1b5e20;
      --medium-bg: #e3f2fd;
      --medium-text: #0d47a1;
      --hard-bg: #fff3e0;
      --hard-text: #e65100;
      --impossible-bg: #ffebee;
      --impossible-text: #b71c1c;
      /* Ø£Ù„ÙˆØ§Ù† Ø£Ø®Ø±Ù‰ */
      --primary: #007bff;
      --success: #28a745;
      --danger: #dc3545;
      --warning: #ffc107;
      --gold: #f1c40f;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: var(--font-main);
      background: var(--color-dark);
      color: var(--color-light);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    /* ==============================
      Ø§Ù„Ø´Ø§Ø´Ø§Øª (Screens)
    ============================== */
    .screen {
      display: none;
      width: 100%;
      max-width: 480px;
      padding: 20px;
      text-align: center;
      border-radius: 16px;
      background: rgba(0, 0, 0, 0.8);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }
    .screen.active {
      display: block;
      opacity: 1;
      transform: scale(1);
    }
    /* Splash Screen */
    #loader {
      background: var(--color-dark);
      color: var(--gold);
    }
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid var(--color-light);
      border-top-color: transparent;
      border-radius: 50%;
      margin: 20px auto;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
    /* ==============================
      Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
    ============================== */
    h1.game-title {
      font-size: 2rem;
      margin-bottom: 15px;
    }
    h2, h3 {
      margin-bottom: 10px;
    }
    /* ==============================
      Ø§Ù„Ø£Ø²Ø±Ø§Ø± (Buttons)
    ============================== */
    button {
      font: inherit;
      cursor: pointer;
      padding: 10px 20px;
      border-radius: 10px;
      border: none;
      margin: 5px;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      transform: scale(1.05);
    }
    .btn-main {
      background: var(--primary);
      color: #fff;
    }
    .btn-secondary {
      background: var(--color-gray);
      color: #fff;
    }
    .btn-success {
      background: var(--success);
      color: #fff;
    }
    .btn-danger {
      background: var(--danger);
      color: #fff;
    }
    .btn-warning {
      background: var(--warning);
      color: #000;
    }
    /* ==============================
      Ø´Ø§Ø´Ø§Øª Ø®Ø§ØµØ©
    ============================== */
    .avatar-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, 70px);
      gap: 10px;
      justify-content: center;
    }
    .avatar-grid img {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      border: 3px solid transparent;
      cursor: pointer;
      transition: transform 0.3s ease, border-color 0.3s ease;
    }
    .avatar-grid img:hover {
      transform: scale(1.1);
    }
    .avatar-grid img.selected {
      border-color: var(--gold);
    }
    .input-group {
      margin: 15px 0;
    }
    .input-group input {
      width: 100%;
      padding: 10px;
      border: 2px solid var(--color-border);
      border-radius: 10px;
    }
    /* ==============================
      Ø§Ù„Ù„Ø¹Ø¨Ø© (Game Container)
    ============================== */
    #gameContainer {
      background: rgba(255, 255, 255, 0.05);
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .player-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 0;
    }
    .player-main img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
    }
    .helpers {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 10px 0;
    }
    .helper-btn {
      background: var(--color-gray);
      color: #fff;
      font-size: 0.9rem;
      padding: 8px 12px;
      border-radius: 8px;
    }
    .helper-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    /* Ø§Ù„Ù…Ø¤Ù‚Øª */
    .timer-container {
      position: relative;
      margin: 15px 0;
      height: 12px;
      background: var(--color-border);
      border-radius: 6px;
      overflow: hidden;
    }
    .timer-bar {
      height: 100%;
      background: var(--primary);
      width: 100%;
      transition: width 1s linear;
    }
    .timer-text {
      margin-top: 5px;
      font-weight: bold;
    }
    /* ==============================
      Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆÙ„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©
    ============================== */
    .final-stats,
    #leaderboardContent {
      text-align: left;
      margin: 15px 0;
    }
    .share-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    .share-btn {
      padding: 8px 12px;
      border-radius: 8px;
      color: #fff;
    }
    .share-btn.x {
      background: #000;
    }
    .share-btn.instagram {
      background: #e1306c;
    }
    /* ==============================
      Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª (Themes)
    ============================== */
    body[data-level='easy'] {
      background: var(--easy-bg);
      color: var(--easy-text);
    }
    body[data-level='medium'] {
      background: var(--medium-bg);
      color: var(--medium-text);
    }
    body[data-level='hard'] {
      background: var(--hard-bg);
      color: var(--hard-text);
    }
    body[data-level='impossible'] {
      background: var(--impossible-bg);
      color: var(--impossible-text);
    }
    /* ==============================
      Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„ÙØ§ØªØ­
    ============================== */
    body[data-theme='light'] {
      background: var(--color-light);
      color: var(--color-dark);
    }
    body[data-theme='dark'] {
      background: var(--color-dark);
      color: var(--color-light);
    }
    /* ==============================
      Responsive Design
    ============================== */
    @media (max-width: 768px) {
      .screen {
        max-width: 100%;
        border-radius: 0;
        padding: 15px;
      }
      .avatar-grid {
        grid-template-columns: repeat(auto-fill, 60px);
      }
    }
    @media (max-width: 480px) {
      h1.game-title {
        font-size: 1.5rem;
      }
      .btn-main,
      .btn-secondary {
        width: 100%;
      }
      .player-info {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>

</head>
<body data-theme="dark">

  <div id="splashScreen" class="screen active">
    <div class="content-box">
      <h1 class="game-title">ğŸ§  Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h1>
      <p class="game-desc">Ø§Ø®ØªØ¨Ø± Ù‚Ø¯Ø±Ø§ØªÙƒ ÙÙŠ Ù…Ø³Ø§Ø¨Ù‚Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ø´ÙŠÙ‚Ø© Ù…Ù„ÙŠØ¦Ø© Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª!</p>
      <div class="spinner"></div>
    </div>
  </div>

  <div id="startScreen" class="screen hidden">
    <div class="content-box">
      <h2>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ğŸ‘‹</h2>
      <button id="goToAvatar" class="btn-main">Ø§Ø¨Ø¯Ø£</button>
      <button id="showLeaderboardBtn" class="btn-secondary">Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©</button>
    </div>
  </div>

  <div id="avatarScreen" class="screen hidden">
    <h2>ğŸ‘¤ Ø§Ø®ØªØ± ØµÙˆØ±ØªÙƒ Ø§Ù„Ø±Ù…Ø²ÙŠØ©</h2>
    <div class="avatar-grid"></div>
    <button id="confirmAvatarBtn" class="btn-main">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  </div>

  <div id="nameScreen" class="screen hidden">
    <h2>ğŸ“ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ</h2>
    <input type="text" id="playerNameInput" placeholder="Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
    <p>ğŸ” Ù…Ø¹Ø±ÙÙƒ (ID): <span id="playerID"></span></p>
    <button id="confirmNameBtn" class="btn-main">ØªØ£ÙƒÙŠØ¯</button>
  </div>

  <div id="instructionsScreen" class="screen hidden">
    <h2>ğŸ“– Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª</h2>
    <ul>
      <li>ğŸ¯ ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© = +100 Ù†Ù‚Ø·Ø©</li>
      <li>âŒ ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø© = -100 Ù†Ù‚Ø·Ø©</li>
      <li>â±ï¸ Ù„Ø¯ÙŠÙƒ 60 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„</li>
      <li>ğŸ›¡ï¸ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø§Øª (50:50 â€“ ØªØ¬Ù…ÙŠØ¯ Ø§Ù„ÙˆÙ‚Øª â€“ ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„)</li>
      <li>ğŸ“© Ø¹Ù†Ø¯ Ù…ÙˆØ§Ø¬Ù‡Ø© Ù…Ø´ÙƒÙ„Ø© ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø±
        <a href="https://x.com/_MS_AbuQusay?t=Tv0klH2PdnBYFHj_G8uIEA&s=09" target="_blank">Ø¥ÙƒØ³</a> Ø£Ùˆ
        <a href="https://www.instagram.com/ms_abuqusay?igsh=MXc2ZWptd2FkamN0" target="_blank">Ø¥Ù†Ø³ØªØºØ±Ø§Ù…</a>
      </li>
    </ul>
    <button id="startGameBtn" class="btn-main">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
  </div>

  <main id="gameContainer" class="screen hidden">
    <div class="top-bar">
      <button id="exitGameBtn">ğŸšª Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</button>
      <div id="progressBar">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1ï¸âƒ£</div>
    </div>
    <div class="question-box">
      <p id="questionText"></p>
      <div id="optionsContainer"></div>
    </div>
    <div class="timer">
      â±ï¸ <span id="timeLeft">60</span> Ø«Ø§Ù†ÙŠØ©
    </div>
  </main>

  <div id="confirmExitScreen" class="screen hidden">
    <p>Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©ØŸ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ù†Ù‚Ø§Ø·Ùƒ.</p>
    <button id="confirmExitYes">âœ… Ù†Ø¹Ù…</button>
    <button id="confirmExitNo">âŒ Ù„Ø§</button>
  </div>

  <div id="endScreen" class="screen hidden">
    <h2>ğŸ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
    <p>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: <span id="finalName"></span></p>
    <p>ğŸ” Ø§Ù„Ù…Ø¹Ø±Ù‘Ù: <span id="finalID"></span></p>
    <p>âœ… Ø§Ù„ØµØ­ÙŠØ­Ø©: <span id="correctAnswers"></span></p>
    <p>âŒ Ø§Ù„Ø®Ø§Ø·Ø¦Ø©: <span id="wrongAnswers"></span></p>
    <p>â­ Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="finalScore"></span></p>
    <button id="goLeaderboard" class="btn-main">Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©</button>
  </div>

  <div id="leaderboardScreen" class="screen hidden">
    <h2>ğŸ† Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©</h2>
    <table id="leaderboardTable">
      <thead>
        <tr><th>Ø§Ù„ØªØ±ØªÙŠØ¨</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>ID</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="backToStart" class="btn-secondary">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
  </div>

  <script>
    class QuizGame {
      constructor() {
        this.API_URL = "https://script.google.com/macros/s/AKfycbw68QqjhU0eqOszPpLBm0tXPtjaSV000kBfOWiorLk2lFm45ud3do-f5PMCy9b0LSez/exec";
        this.QUESTION_TIME = 80;
        this.TOTAL_AVATARS = 16;
        this.LIMIT_PER_DAY = 2;
        this.MAX_WRONG_ANSWERS = 3;
        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØµØ¹ÙˆØ¨Ø© Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
        this.QUESTIONS = {
          easy: [{
            q: "Ù…Ø§ Ù‡Ùˆ Ù„ÙˆÙ† Ø§Ù„Ø³Ù…Ø§Ø¡ ÙÙŠ ÙŠÙˆÙ… Ù…Ø´Ù…Ø³ØŸ",
            options: ["Ø£Ø²Ø±Ù‚", "Ø£Ø®Ø¶Ø±", "Ø£ØµÙØ±", "ÙˆØ±Ø¯ÙŠ"],
            correct: 0
          }, {
            q: "Ù…Ø§Ø°Ø§ ÙŠØ´Ø±Ø¨ Ø§Ù„Ù†Ø§Ø³ Ø¹Ø§Ø¯Ø© ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­ØŸ",
            options: ["Ø¹ØµÙŠØ± Ø¨Ø±ØªÙ‚Ø§Ù„", "Ø´Ø§ÙŠ Ø£Ùˆ Ù‚Ù‡ÙˆØ©", "Ù…Ø§Ø¡", "Ù…Ø´Ø±ÙˆØ¨Ø§Øª ØºØ§Ø²ÙŠØ©"],
            correct: 1
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø°ÙŠ Ù†Ø¹ÙŠØ´ Ø¹Ù„ÙŠÙ‡ØŸ",
            options: ["Ø§Ù„Ù…Ø±ÙŠØ®", "Ø§Ù„Ø£Ø±Ø¶", "Ø§Ù„Ø²Ù‡Ø±Ø©", "Ø¹Ø·Ø§Ø±Ø¯"],
            correct: 1
          }, {
            q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµØ§Ø¨Ø¹ ÙÙŠ ÙŠØ¯ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ØŸ",
            options: ["Ø£Ø±Ø¨Ø¹Ø©", "Ø®Ù…Ø³Ø©", "Ø³ØªØ©", "Ø³Ø¨Ø¹Ø©"],
            correct: 1
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø°ÙŠ ÙŠØªÙƒÙˆÙ† Ù…Ù† Ù…Ø²Ø¬ Ø§Ù„Ø£Ø­Ù…Ø± ÙˆØ§Ù„Ø£Ø²Ø±Ù‚ØŸ",
            options: ["Ø£Ø®Ø¶Ø±", "Ø£ØµÙØ±", "Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ", "Ø¨Ù†ÙØ³Ø¬ÙŠ"],
            correct: 3
          }],
          medium: [{
            q: "Ø£ÙŠÙ† ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØ¬Ø¯ Ø§Ù„Ø£Ù‡Ø±Ø§Ù…Ø§Øª Ø§Ù„Ø´Ù‡ÙŠØ±Ø©ØŸ",
            options: ["ÙÙŠ Ø§Ù„Ù‡Ù†Ø¯", "ÙÙŠ Ù…ØµØ±", "ÙÙŠ Ø§Ù„ØµÙŠÙ†", "ÙÙŠ Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ"],
            correct: 1
          }, {
            q: "Ø£ÙŠ Ø­ÙŠÙˆØ§Ù† ÙŠØ¹Ø¯ Ø£Ø·ÙˆÙ„ Ø­ÙŠÙˆØ§Ù† Ø¹Ù„Ù‰ ÙˆØ¬Ù‡ Ø§Ù„Ø£Ø±Ø¶ØŸ",
            options: ["Ø§Ù„ÙÙŠÙ„", "Ø§Ù„Ø²Ø±Ø§ÙØ©", "Ø§Ù„Ø­ÙˆØª Ø§Ù„Ø£Ø²Ø±Ù‚", "Ø§Ù„ÙÙ‡Ø¯"],
            correct: 1
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø·Ø§Ø¦Ø± Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ±Ø§Ø¡ØŸ",
            options: ["Ø§Ù„Ø¨Ø·Ø±ÙŠÙ‚", "Ø§Ù„ØµÙ‚Ø±", "Ø§Ù„Ø·Ø§Ø¦Ø± Ø§Ù„Ø·Ù†Ø§Ù†", "Ø§Ù„Ù†Ø³Ø±"],
            correct: 2
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ Ø­ÙŠÙˆØ§Ù† Ø¨Ø±ÙŠØŸ",
            options: ["Ø§Ù„ÙÙ‡Ø¯", "Ø§Ù„Ø£Ø³Ø¯", "Ø§Ù„Ù†Ù…Ø±", "Ø§Ù„Ø­Ù…Ø§Ø± Ø§Ù„ÙˆØ­Ø´ÙŠ"],
            correct: 0
          }, {
            q: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØªÙŠ ØªÙ‚Ø§Ø³ Ø¨Ù‡Ø§ Ø§Ù„Ø­Ø±Ø§Ø±Ø©ØŸ",
            options: ["Ø§Ù„Ù„ØªØ±", "Ø§Ù„Ù…ØªØ±", "Ø§Ù„Ø³Ù„Ø³ÙŠÙˆØ³", "Ø§Ù„ÙƒÙŠÙ„ÙˆØºØ±Ø§Ù…"],
            correct: 2
          }],
          hard: [{
            q: "Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± Ù…Ø­ÙŠØ· ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ",
            options: ["Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø£Ø·Ù„Ø³ÙŠ", "Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ù†Ø¯ÙŠ", "Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ø§Ø¯Ø¦", "Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù…ØªØ¬Ù…Ø¯ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠ"],
            correct: 2
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£Ø·ÙˆÙ„ Ù†Ù‡Ø± ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ",
            options: ["Ù†Ù‡Ø± Ø§Ù„Ù†ÙŠÙ„", "Ù†Ù‡Ø± Ø§Ù„Ø£Ù…Ø§Ø²ÙˆÙ†", "Ù†Ù‡Ø± Ø§Ù„ÙŠØ§Ù†ØºØªØ³ÙŠ", "Ù†Ù‡Ø± Ø§Ù„Ù…ÙŠØ³ÙŠØ³ÙŠØ¨ÙŠ"],
            correct: 0
          }, {
            q: "Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù Ø±ÙˆØ§ÙŠØ© 'Ù‡Ø§Ø±ÙŠ Ø¨ÙˆØªØ±'ØŸ",
            options: ["Ø¬ÙŠ. Ùƒ. Ø±ÙˆÙ„ÙŠÙ†Øº", "Ø¥Ø±Ù†Ø³Øª Ù‡Ù…Ù†ØºÙˆØ§ÙŠ", "Ù„ÙŠÙˆ ØªÙˆÙ„Ø³ØªÙˆÙŠ", "Ø´Ø§Ø±Ù„Ø² Ø¯ÙŠÙƒÙ†Ø²"],
            correct: 0
          }, {
            q: "Ø£ÙŠÙ† ØªÙ‚Ø¹ Ù…Ø¯ÙŠÙ†Ø© Ù†ÙŠÙˆÙŠÙˆØ±ÙƒØŸ",
            options: ["ÙÙŠ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø© Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠØ©", "ÙÙŠ ÙƒÙ†Ø¯Ø§", "ÙÙŠ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„", "ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©"],
            correct: 0
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø­ÙŠÙˆØ§Ù† Ø§Ù„Ø°ÙŠ ÙŠÙ„Ø¯ ÙˆÙ„ÙŠØ³ ÙŠØ¨ÙŠØ¶ØŸ",
            options: ["Ø§Ù„Ø³Ù…ÙƒØ©", "Ø§Ù„Ø³Ù„Ø­ÙØ§Ø©", "Ø§Ù„Ø«Ø¹Ù„Ø¨", "Ø§Ù„Ø¯Ø¬Ø§Ø¬Ø©"],
            correct: 2
          }],
          impossible: [{
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ù…Ù‚Ø¯Ø³ Ù„Ø¯Ù‰ Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ†ØŸ",
            options: ["Ø§Ù„Ø¥Ù†Ø¬ÙŠÙ„", "Ø§Ù„ØªÙˆØ±Ø§Ø©", "Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…", "Ø§Ù„Ø²Ø¨ÙˆØ±"],
            correct: 2
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø°ÙŠ ÙŠØ³Ù…Ù‰ 'Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø­Ù…Ø±'ØŸ",
            options: ["Ø§Ù„Ø²Ù‡Ø±Ø©", "Ø§Ù„Ù…Ø±ÙŠØ®", "Ø¹Ø·Ø§Ø±Ø¯", "Ø§Ù„Ø£Ø±Ø¶"],
            correct: 1
          }, {
            q: "Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø£Ø´Ù‡Ø± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ø³Ù„ØŸ",
            options: ["Ø¹Ø³Ù„ Ø§Ù„Ø²Ù‡ÙˆØ±", "Ø¹Ø³Ù„ Ø§Ù„Ù†Ø­Ù„", "Ø¹Ø³Ù„ Ø§Ù„Ø²Ø¹ØªØ±", "Ø¹Ø³Ù„ Ø§Ù„Ø³Ø¯Ø±"],
            correct: 2
          }, {
            q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ",
            options: ["4", "5", "6", "7"],
            correct: 3
          }, {
            q: "Ù…Ù† Ù‡Ùˆ Ø£Ø´Ù‡Ø± Ù…Ø®ØªØ±Ø¹ Ù„Ù„Ù…ØµØ¨Ø§Ø­ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØŸ",
            options: ["ØªÙˆÙ…Ø§Ø³ Ø¥Ø¯ÙŠØ³ÙˆÙ†", "Ù†ÙŠÙƒÙˆÙ„Ø§ ØªØ³Ù„Ø§", "Ø£Ù„ÙƒØ³Ù†Ø¯Ø± ØºØ±Ø§Ù‡Ø§Ù… Ø¨ÙŠÙ„", "Ø¬ÙŠÙ…Ø³ ÙˆØ§Øª"],
            correct: 0
          }]
        };
        // Ø£Ø³Ø¦Ù„Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰
        this.backupQuestions = {
          easy: {
            q: "Ù…Ø§ Ù‡Ùˆ ØµÙˆØª Ø§Ù„Ù‚Ø·Ø©ØŸ",
            options: ["Ù…ÙˆØ§Ø¡", "Ù†Ø¨Ø§Ø­", "ØµÙŠØ§Ø­", "Ù‡Ø¯ÙŠÙ„"],
            correct: 0
          },
          medium: {
            q: "Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ Ø­ÙŠÙˆØ§Ù† Ø¨Ø­Ø±ÙŠØŸ",
            options: ["Ø§Ù„Ø¯Ù„ÙÙŠÙ†", "Ø§Ù„Ù‚Ø±Ø´", "Ø§Ù„ØªÙˆÙ†Ø©", "Ø³Ù…Ùƒ Ø£Ø¨Ùˆ Ø³ÙŠÙ"],
            correct: 3
          },
          hard: {
            q: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§ØŸ",
            options: ["Ø³ÙŠØ¯Ù†ÙŠ", "Ù…Ù„Ø¨ÙˆØ±Ù†", "ÙƒØ§Ù†Ø¨Ø±Ø§", "Ø¨Ø±ÙŠØ²Ø¨Ø§Ù†"],
            correct: 2
          },
          impossible: {
            q: "Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù Ù…Ø³Ø±Ø­ÙŠØ© 'Ù‡Ø§Ù…Ù„Øª'ØŸ",
            options: ["Ø´ÙƒØ³Ø¨ÙŠØ±", "ØªØ´ÙŠØ®ÙˆÙ", "Ø¥Ø¨Ø³Ù†", "Ø¨Ø±ÙŠØ®Øª"],
            correct: 0
          }
        };
        this.PRIZES = [{
          points: 100,
          title: "ÙƒØ§Ø¯ÙŠÙ„"
        }, {
          points: 200,
          title: "Ø³ÙŠØ±ÙŠØ³"
        }, {
          points: 300,
          title: "Ø§ÙˆØªÙˆ"
        }, {
          points: 500,
          title: "Ù…ÙŠÙƒØ§"
        }, {
          points: 1000,
          title: "ØºØ±Ø§ÙŠ"
        }, {
          points: 2000,
          title: "Ø¨Ø§ÙŠØ±ÙˆÙ†"
        }, {
          points: 4000,
          title: "Ø³ÙŠÙ„ÙÙŠ"
        }, {
          points: 8000,
          title: "ÙØ§Ø±Ø§ÙŠ"
        }, {
          points: 16000,
          title: "Ø´ÙˆÙ„"
        }, {
          points: 32000,
          title: "Ø§Ù„Ø¯ÙŠØ±"
        }, {
          points: 64000,
          title: "ÙˆÙŠÙ†Ø¯Ø³ÙˆÙ…"
        }, {
          points: 125000,
          title: "Ù…ÙˆØ±Ø¯Ø§ÙŠÙ†"
        }, {
          points: 250000,
          title: "ÙƒÙŠØ²ÙŠØ³"
        }, {
          points: 500000,
          title: "Ø£ØºØ±ÙˆÙ†Ø§"
        }, {
          points: 1000000,
          title: "Ø£Ø±Ø«Ø±"
        }];
        this.HELPER_COSTS = {
          fiftyFifty: 100,
          freezeTime: 100,
          changeQuestion: 100
        };
        this.isTimeFrozen = false;
        this.gameState = {
          level: 'easy',
          levelProgress: 0,
          levelsCompleted: {
            easy: false,
            medium: false,
            hard: false,
            impossible: false
          }
        };
        this.currentScoreValue = 0;
        this.timerInterval = null;
        this.answerSubmitted = false;
        this.domElements = {};
        this.init();
      }
      init() {
        this.cacheDomElements();
        this.bindEventListeners();
        this.populateAvatarGrid();
        this.generatePrizesList();
        this.displayHelperCosts();
        this.loadTheme();
        this.showScreen('start');
        this.hideLoader();
        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        this.animateElements();
      }
      cacheDomElements() {
        this.domElements = {
          screens: {
            loader: document.getElementById('loader'),
            start: document.getElementById('startScreen'),
            avatar: document.getElementById('avatarScreen'),
            nameEntry: document.getElementById('nameEntry'),
            welcome: document.getElementById('welcomeScreen'),
            game: document.getElementById('gameContainer'),
            end: document.getElementById('endScreen'),
            leaderboard: document.getElementById('leaderboardScreen'),
            levelTransition: document.getElementById('levelTransitionScreen')
          },
          sidebar: document.querySelector('.sidebar'),
          sidebarOverlay: document.querySelector('.sidebar-overlay'),
          questionText: document.getElementById('questionText'),
          optionsGrid: document.querySelector('.options-grid'),
          scoreDisplay: document.getElementById('currentScore'),
          prizesList: document.querySelector('.prizes-list'),
          helperBtns: document.querySelectorAll('.helper-btn'),
          nameInput: document.getElementById('nameInput'),
          nameError: document.getElementById('nameError'),
          confirmAvatarBtn: document.getElementById('confirmAvatarBtn'),
          themeToggleBtn: document.querySelector('.theme-toggle-btn'),
          welcomeMessage: document.getElementById('welcomeMessage'),
          cooldownContainer: document.getElementById('cooldownContainer'),
          cooldownTimer: document.getElementById('cooldownTimer'),
          attemptsCount: document.getElementById('attemptsCount'),
          attemptsLeft: document.getElementById('attemptsLeft'),
          levelTitle: document.getElementById('levelTitle'),
          levelDescription: document.getElementById('levelDescription'),
          levelProgressBar: document.getElementById('levelProgressBar'),
          levelIndicator: document.getElementById('levelIndicator')
        };
      }
      bindEventListeners() {
        document.getElementById('startPlayBtn').addEventListener('click', () => this.showScreen('avatar'));
        this.domElements.confirmAvatarBtn.addEventListener('click', () => this.showScreen('nameEntry'));
        document.getElementById('confirmNameBtn').addEventListener('click', () => this.showWelcomeScreen());
        document.getElementById('welcomeConfirmBtn').addEventListener('click', () => this.startGame());
        document.getElementById('showLeaderboardBtn').addEventListener('click', () => this.displayLeaderboard());
        document.getElementById('backToStartBtn').addEventListener('click', () => this.showScreen('start'));
        this.domElements.themeToggleBtn.addEventListener('click', () => this.toggleTheme());
        document.getElementById('statsBtn').addEventListener('click', () => this.displayLeaderboard());
        document.querySelector('.open-sidebar-btn').addEventListener('click', () => this.toggleSidebar(true));
        document.querySelector('.close-sidebar-btn').addEventListener('click', () => this.toggleSidebar(false));
        this.domElements.sidebarOverlay.addEventListener('click', () => this.toggleSidebar(false));
        this.domElements.helperBtns.forEach(btn => btn.addEventListener('click', (e) => this.useHelper(e)));
        document.getElementById('shareXBtn').addEventListener('click', () => this.shareOnX());
        document.getElementById('shareInstagramBtn').addEventListener('click', () => this.shareOnInstagram());
        this.domElements.nameInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') this.showWelcomeScreen();
        });
        // Ø£Ø­Ø¯Ø§Ø« Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
        document.getElementById('nextLevelBtn').addEventListener('click', () => this.goToNextLevel());
        document.getElementById('showResultsAfterLevelBtn').addEventListener('click', () => this.showResultsAfterLevel());
        document.getElementById('quitAfterLevelBtn').addEventListener('click', () => this.quitAfterLevel());
      }
      populateAvatarGrid() {
        const avatarGrid = document.querySelector('.avatar-grid');
        avatarGrid.innerHTML = '';
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù…ÙˆØ² ØªØ¹Ø¨ÙŠØ±ÙŠØ© ÙƒØµÙˆØ± Ø±Ù…Ø²ÙŠØ© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ØµÙˆØ±
        const emojiAvatars = ['ğŸ˜Š', 'ğŸ˜', 'ğŸ¤ ', 'ğŸ§', 'ğŸ¥³', 'ğŸ˜', 'ğŸ¤©', 'ğŸ˜‡', 'ğŸ§ ', 'ğŸ¦¸', 'ğŸ¦¹', 'ğŸ‘¨â€ğŸ’»', 'ğŸ‘©â€ğŸ”¬', 'ğŸ‘¨â€ğŸ¨', 'ğŸ‘©â€ğŸš€', 'ğŸ‘¨â€ğŸ³'];
        for (let i = 0; i < this.TOTAL_AVATARS; i++) {
          const avatarItem = document.createElement('div');
          avatarItem.classList.add('avatar-option');
          avatarItem.innerHTML = `<span style="font-size: 2.5rem;">${emojiAvatars[i]}</span>`;
          avatarItem.addEventListener('click', () => {
            document.querySelectorAll('.avatar-option.selected').forEach(el => el.classList.remove('selected'));
            avatarItem.classList.add('selected');
            this.gameState.avatar = emojiAvatars[i];
            this.domElements.confirmAvatarBtn.disabled = false;
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ¯
            avatarItem.style.transform = 'scale(1.1)';
            setTimeout(() => {
              avatarItem.style.transform = 'scale(1)';
            }, 300);
          });
          avatarGrid.appendChild(avatarItem);
        }
      }
      showWelcomeScreen() {
        const name = this.domElements.nameInput.value.trim();
        if (name.length < 2) {
          this.domElements.nameError.textContent = "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØµØ­ÙŠØ­ (Ø­Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„).";
          this.domElements.nameError.classList.add('show');
          return;
        }
        this.domElements.nameError.classList.remove('show');
        this.gameState.name = name;
        this.domElements.welcomeMessage.innerHTML = `ğŸŒŸ Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙŠØ§ ${name}! ğŸŒŸ`;
        if (this.domElements.attemptsCount) {
          this.domElements.attemptsCount.textContent = this.LIMIT_PER_DAY;
        }
        this.showScreen('welcome');
      }
      async startGame() {
        this.showScreen('loader');
        try {
          const response = await this.apiCall({
            action: 'start',
            deviceId: this.getDeviceId(),
            name: this.gameState.name,
          });
          if (response && response.success) {
            document.getElementById('startPlayBtn').disabled = false;
            this.domElements.cooldownContainer.style.display = 'none';
            this.resetGameState(response.attemptId);
            this.gameState.attemptsLeft = response.attemptsLeft;
            this.setupGameUI();
            this.showScreen('game');
            this.startLevel('easy');
          } else if (response && response.error === 'limit_reached') {
            this.showScreen('start');
            this.startCooldownTimer(response.cooldownEnd);
          } else {
            this.showToast("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©.", 'error');
            this.showScreen('start');
          }
        } catch (error) {
          console.error("Error starting game:", error);
          this.showToast("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….", "error");
          this.showScreen('start');
        }
      }
      // Ø¨Ø¯Ø¡ Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯
      startLevel(level) {
        this.gameState.level = level;
        this.gameState.levelProgress = 0;
        this.gameState.shuffledQuestions = this.shuffleQuestions(this.QUESTIONS[level]);
        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯
        this.updateLevelUI(level);
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„
        this.fetchQuestion();
      }
      // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ
      updateLevelUI(level) {
        // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰
        if (this.domElements.levelIndicator) {
          this.domElements.levelIndicator.textContent = this.getLevelName(level);
        }
        // ØªØ­Ø¯ÙŠØ« ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰
        this.updateLevelProgress();
        // ØªØ·Ø¨ÙŠÙ‚ Ø³Ù…Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰
        document.body.setAttribute('data-level', level);
        // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
        this.applyLevelTheme(level);
      }
      // ØªØ·Ø¨ÙŠÙ‚ Ø³Ù…Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      applyLevelTheme(level) {
        const themeColors = {
          easy: {
            primary: '#2ec4b6',
            secondary: '#2a9d8f',
            accent: '#2ec4b6'
          },
          medium: {
            primary: '#4361ee',
            secondary: '#3a0ca3',
            accent: '#4361ee'
          },
          hard: {
            primary: '#ff9f1c',
            secondary: '#ff6b6b',
            accent: '#ff9f1c'
          },
          impossible: {
            primary: '#e71d36',
            secondary: '#9d0208',
            accent: '#e71d36'
          }
        };
        const colors = themeColors[level];
        document.documentElement.style.setProperty('--level-primary', colors.primary);
        document.documentElement.style.setProperty('--level-secondary', colors.secondary);
        document.documentElement.style.setProperty('--level-accent', colors.accent);
      }
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
      getLevelName(level) {
        const levelNames = {
          easy: "Ø³Ù‡Ù„",
          medium: "Ù…ØªÙˆØ³Ø·",
          hard: "ØµØ¹Ø¨",
          impossible: "Ù…Ø³ØªØ­ÙŠÙ„"
        };
        return levelNames[level] || level;
      }
      shuffleQuestions(questions) {
        const shuffled = [...questions];
        for (let i = shuffled.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
      }
      fetchQuestion() {
        if (this.gameState.shuffledQuestions.length === 0) {
          // Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ØŒ Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
          this.completeLevel();
          return;
        }
        const currentQuestionData = this.gameState.shuffledQuestions[this.gameState.levelProgress];
        this.displayQuestion(currentQuestionData);
      }
      displayQuestion(questionData) {
        this.answerSubmitted = false;
        this.domElements.questionText.textContent = questionData.q;
        document.getElementById('questionCounter').textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${this.gameState.levelProgress + 1} / ${this.QUESTIONS[this.gameState.level].length}`;
        this.domElements.optionsGrid.innerHTML = '';
        let answers = questionData.options.map((optionText, index) => ({
          text: optionText,
          isCorrect: index === questionData.correct
        }));
        for (let i = answers.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [answers[i], answers[j]] = [answers[j], answers[i]];
        }
        answers.forEach(answer => {
          const button = document.createElement('button');
          button.className = 'option-btn';
          button.textContent = answer.text;
          if (answer.isCorrect) {
            button.dataset.correct = 'true';
          }
          button.addEventListener('click', () => this.checkAnswer(answer.isCorrect, button));
          this.domElements.optionsGrid.appendChild(button);
        });
        this.updateUI();
        this.startTimer();
      }
      checkAnswer(isCorrect, selectedButton) {
        if (this.answerSubmitted) return;
        this.answerSubmitted = true;
        clearInterval(this.timerInterval);
        document.querySelectorAll('.option-btn').forEach(b => b.classList.add('disabled'));
        if (isCorrect) {
          selectedButton.classList.add('correct');
          const pointsEarned = 100; // Ù†Ù‚Ø§Ø· Ø«Ø§Ø¨ØªØ© Ù„ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©
          this.updateScore(this.currentScoreValue + pointsEarned);
          this.gameState.levelProgress++;
          this.updateLevelProgress();
        } else {
          selectedButton.classList.add('wrong');
          const correctButton = this.domElements.optionsGrid.querySelector('[data-correct="true"]');
          if (correctButton) {
            correctButton.classList.add('correct');
          }
          this.gameState.wrongAnswers++;
        }
        this.updateUI();
        const isGameOver = this.gameState.wrongAnswers >= this.MAX_WRONG_ANSWERS;
        const isLevelComplete = this.gameState.levelProgress >= this.QUESTIONS[this.gameState.level].length;
        setTimeout(() => {
          if (isGameOver) {
            this.endGame();
          } else if (isLevelComplete) {
            this.completeLevel();
          } else {
            this.fetchQuestion();
          }
        }, 2000);
      }
      // Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ
      completeLevel() {
        this.gameState.levelsCompleted[this.gameState.level] = true;
        // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
        this.showLevelTransition();
      }
      // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
      showLevelTransition() {
        const levelNames = {
          easy: "Ø³Ù‡Ù„",
          medium: "Ù…ØªÙˆØ³Ø·",
          hard: "ØµØ¹Ø¨",
          impossible: "Ù…Ø³ØªØ­ÙŠÙ„"
        };
        const currentLevelName = levelNames[this.gameState.level];
        const nextLevel = this.getNextLevel();
        if (nextLevel) {
          const nextLevelName = levelNames[nextLevel];
          // ØªØ­Ø¯ÙŠØ« Ù…Ø­ØªÙˆÙ‰ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
          document.getElementById('levelTransitionTitle').textContent = `ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${currentLevelName}`;
          document.getElementById('levelTransitionDesc').textContent = `Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${this.currentScoreValue} Ù†Ù‚Ø·Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ ${nextLevelName}!`;
          // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
          this.showScreen('levelTransition');
        } else {
          // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø¢Ø®Ø± Ù…Ø³ØªÙˆÙ‰ØŒ Ø§Ù†Ù‡ÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©
          this.endGame();
        }
      }
      // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
      goToNextLevel() {
        const nextLevel = this.getNextLevel();
        if (nextLevel) {
          this.startLevel(nextLevel);
          this.showScreen('game');
        } else {
          this.endGame();
        }
      }
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
      getNextLevel() {
        const levels = ['easy', 'medium', 'hard', 'impossible'];
        const currentIndex = levels.indexOf(this.gameState.level);
        if (currentIndex < levels.length - 1) {
          return levels[currentIndex + 1];
        }
        return null;
      }
      // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      showResultsAfterLevel() {
        this.endGame();
      }
      // Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      quitAfterLevel() {
        this.showScreen('start');
      }
      endGame() {
        clearInterval(this.timerInterval);
        const totalTimeSeconds = (new Date() - new Date(this.gameState.startTime)) / 1000;
        const finalTitle = this.getFinalTitle();
        this.gameState.finalStats = {
          name: this.gameState.name,
          title: finalTitle,
          score: this.currentScoreValue,
          time: this.formatTime(totalTimeSeconds),
          level: this.gameState.level,
          levelsCompleted: this.gameState.levelsCompleted
        };
        document.getElementById('finalName').textContent = this.gameState.finalStats.name;
        document.getElementById('finalTitle').textContent = this.gameState.finalStats.title;
        document.getElementById('finalScore').textContent = this.formatNumber(this.gameState.finalStats.score);
        document.getElementById('totalTime').textContent = this.gameState.finalStats.time;
        this.showScreen('end');
        this.apiCall({
          action: 'end',
          attemptId: this.gameState.attemptId,
          deviceId: this.gameState.deviceId,
          name: this.gameState.name,
          score: this.currentScoreValue,
          finalTitle: finalTitle,
          totalTime: totalTimeSeconds,
          level: this.gameState.level,
          levelsCompleted: JSON.stringify(this.gameState.levelsCompleted)
        }).catch(error => console.error("Failed to save score:", error));
      }
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„Ù‚Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø·
      getFinalTitle() {
        for (let i = this.PRIZES.length - 1; i >= 0; i--) {
          if (this.currentScoreValue >= this.PRIZES[i].points) {
            return this.PRIZES[i].title;
          }
        }
        return "Ù„Ø§ ÙŠÙˆØ¬Ø¯";
      }
      useHelper(event) {
        const btn = event.currentTarget;
        const type = btn.dataset.type;
        const cost = this.HELPER_COSTS[type];
        if (this.currentScoreValue < cost) {
          this.showToast("Ù†Ù‚Ø§Ø·Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠØ©!", "error");
          return;
        }
        this.updateScore(this.currentScoreValue - cost);
        this.gameState.helpersUsed[type] = true;
        btn.disabled = true;
        this.showToast(`ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©!`, "success");
        if (type === 'fiftyFifty') {
          const options = Array.from(this.domElements.optionsGrid.querySelectorAll('.option-btn'));
          let wrongOptions = options.filter(btn => btn.dataset.correct !== 'true');
          wrongOptions.sort(() => 0.5 - Math.random());
          if (wrongOptions.length > 1) {
            wrongOptions[0].classList.add('hidden');
            wrongOptions[1].classList.add('hidden');
          }
        } else if (type === 'freezeTime') {
          this.isTimeFrozen = true;
          document.querySelector('.timer-bar').classList.add('frozen');
          setTimeout(() => {
            this.isTimeFrozen = false;
            document.querySelector('.timer-bar').classList.remove('frozen');
          }, 10000);
        } else if (type === 'changeQuestion') {
          // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø³Ø¤Ø§Ù„ Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
          this.gameState.shuffledQuestions[this.gameState.levelProgress] = this.backupQuestions[this.gameState.level];
          this.fetchQuestion();
        }
        this.updateUI();
      }
      startTimer() {
        clearInterval(this.timerInterval);
        this.gameState.timeLeft = this.QUESTION_TIME;
        const timerBar = document.querySelector('.timer-bar');
        const timerDisplay = document.querySelector('.timer-text');
        this.timerInterval = setInterval(() => {
          if (this.isTimeFrozen) return;
          this.gameState.timeLeft--;
          timerDisplay.textContent = this.gameState.timeLeft;
          timerBar.style.width = `${(this.gameState.timeLeft / this.QUESTION_TIME) * 100}%`;
          if (this.gameState.timeLeft <= 0) {
            clearInterval(this.timerInterval);
            this.showToast("Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!", "error");
            this.gameState.wrongAnswers++;
            document.querySelectorAll('.option-btn').forEach(b => b.classList.add('disabled'));
            const correctButton = this.domElements.optionsGrid.querySelector('[data-correct="true"]');
            if (correctButton) {
              correctButton.classList.add('correct');
            }
            this.updateUI();
            setTimeout(() => {
              if (this.gameState.wrongAnswers >= this.MAX_WRONG_ANSWERS) {
                this.endGame();
              } else {
                this.gameState.levelProgress++;
                this.updateLevelProgress();
                this.fetchQuestion();
              }
            }, 2000);
          }
        }, 1000);
      }
      // ØªØ­Ø¯ÙŠØ« ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      updateLevelProgress() {
        const progress = (this.gameState.levelProgress / this.QUESTIONS[this.gameState.level].length) * 100;
        if (this.domElements.levelProgressBar) {
          this.domElements.levelProgressBar.style.width = `${progress}%`;
        }
      }
      updateScore(newScore) {
        this.currentScoreValue = newScore;
        this.domElements.scoreDisplay.textContent = this.formatNumber(this.currentScoreValue);
        this.updateUI();
      }
      updateUI() {
        document.getElementById('wrongAnswersCount').textContent = `${this.gameState.wrongAnswers} / ${this.MAX_WRONG_ANSWERS}`;
        const currentTitle = this.getFinalTitle();
        document.getElementById('currentTitle').textContent = currentTitle;
        if (this.domElements.attemptsLeft) {
          this.domElements.attemptsLeft.textContent = `${this.gameState.attemptsLeft || this.LIMIT_PER_DAY} / ${this.LIMIT_PER_DAY}`;
        }
        this.updatePrizesList();
        this.domElements.helperBtns.forEach(btn => {
          const type = btn.dataset.type;
          const helperIsUsed = this.gameState.helpersUsed && this.gameState.helpersUsed[type];
          btn.disabled = helperIsUsed || this.currentScoreValue < this.HELPER_COSTS[type];
        });
      }
      generatePrizesList() {
        this.domElements.prizesList.innerHTML = '';
        [...this.PRIZES].reverse().forEach((prize, index) => {
          const li = document.createElement('li');
          li.innerHTML = `<span>${this.PRIZES.length - index}. ${prize.title}</span> <strong>${this.formatNumber(prize.points)}</strong>`;
          this.domElements.prizesList.appendChild(li);
        });
      }
      updatePrizesList() {
        const items = this.domElements.prizesList.querySelectorAll('li');
        items.forEach((item, index) => {
          item.classList.remove('current', 'past');
          const prizeIndex = this.PRIZES.length - 1 - index;
          if (this.currentScoreValue >= this.PRIZES[prizeIndex].points) {
            item.classList.add('past');
          }
        });
      }
      async displayLeaderboard() {
        this.showScreen('leaderboard');
        const contentDiv = document.getElementById('leaderboardContent');
        contentDiv.innerHTML = '<div class="spinner"></div>';
        try {
          const response = await this.apiCall({
            action: 'getLeaderboard'
          });
          if (response && response.success && response.leaderboard) {
            let tableHTML = '<p>Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠÙ‹Ø§!</p>';
            if (response.leaderboard.length > 0) {
              tableHTML = `<table class="leaderboard-table">
                                <tr><th>Ø§Ù„ØªØ±ØªÙŠØ¨</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th><th>Ø§Ù„Ù„Ù‚Ø¨</th><th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th></tr>
                                ${response.leaderboard.map((row, index) => `
                                    <tr class="${index < 3 ? 'rank-' + (index + 1) : ''}">
                                        <td>${['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'][index] || index + 1}</td>
                                        <td>${row.name || row[1]}</td>
                                        <td>${this.formatNumber(row.score || row[2])}</td>
                                        <td>${row.title || row[3]}</td>
                                        <td>${row.level ? this.getLevelName(row.level) : ''}</td>
                                    </tr>`).join('')}
                            </table>`;
            }
            contentDiv.innerHTML = tableHTML;
          } else {
            contentDiv.innerHTML = '<p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©.</p>';
          }
        } catch (error) {
          console.error("Error loading leaderboard:", error);
          contentDiv.innerHTML = '<p>Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØµØ¯Ø§Ø±Ø©.</p>';
        }
      }
      getShareText() {
        const {
          name,
          title,
          score,
          time,
          level
        } = this.gameState.finalStats;
        const levelName = this.getLevelName(level);
        return `âœ¨ Ù†ØªØ§Ø¦Ø¬ÙŠ ÙÙŠ Ù…Ø³Ø§Ø¨Ù‚Ø© "Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù„Ù‚Ø¨" âœ¨\n` +
          `Ø§Ù„Ø§Ø³Ù…: ${name}\n` +
          `Ø§Ù„Ù„Ù‚Ø¨: ${title}\n` +
          `Ø§Ù„Ù†Ù‚Ø§Ø·: ${this.formatNumber(score)}\n` +
          `Ø§Ù„Ù…Ø³ØªÙˆÙ‰: ${levelName}\n` +
          `Ø§Ù„Ù…Ø¯Ø©: ${time}\n\n` +
          `ğŸ”— Ø¬Ø±Ø¨ Ø­Ø¸Ùƒ Ø£Ù†Øª Ø£ÙŠØ¶Ø§Ù‹: ${window.location.href}`;
      }
      shareOnX() {
        const text = encodeURIComponent(this.getShareText());
        window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
      }
      shareOnInstagram() {
        navigator.clipboard.writeText(this.getShareText()).then(() => this.showToast("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©! Ø§Ù„ØµÙ‚Ù‡Ø§ ÙÙŠ Ù‚ØµØªÙƒ Ø£Ùˆ Ø±Ø³Ø§Ø¦Ù„Ùƒ Ø¹Ù„Ù‰ Ø¥Ù†Ø³ØªØºØ±Ø§Ù….", "success")).catch(() => this.showToast("ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©.", "error"));
      }
      resetGameState(attemptId) {
        this.gameState = {
          deviceId: this.getDeviceId(),
          attemptId: attemptId,
          name: this.gameState.name,
          avatar: this.gameState.avatar,
          level: 'easy',
          levelProgress: 0,
          wrongAnswers: 0,
          startTime: new Date().toISOString(),
          helpersUsed: {
            fiftyFifty: false,
            freezeTime: false,
            changeQuestion: false
          },
          shuffledQuestions: [],
          levelsCompleted: {
            easy: false,
            medium: false,
            hard: false,
            impossible: false
          }
        };
        this.updateScore(0);
      }
      setupGameUI() {
        const avatarElement = document.getElementById('playerAvatar');
        if (avatarElement) {
          if (this.gameState.avatar) {
            avatarElement.innerHTML = `<span style="font-size: 2.5rem;">${this.gameState.avatar}</span>`;
          } else {
            avatarElement.innerHTML = '<span style="font-size: 2.5rem;">ğŸ‘¤</span>';
          }
        }
        document.getElementById('playerName').textContent = this.gameState.name;
      }
      toggleTheme() {
        const newTheme = document.body.dataset.theme === 'dark' ? 'light' : 'dark';
        document.body.dataset.theme = newTheme;
        localStorage.setItem('theme', newTheme);
        this.domElements.themeToggleBtn.innerHTML = newTheme === 'dark' ? '<span>â˜€ï¸</span>' : '<span>ğŸŒ™</span>';
      }
      loadTheme() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.body.dataset.theme = savedTheme;
        this.domElements.themeToggleBtn.innerHTML = savedTheme === 'dark' ? '<span>â˜€ï¸</span>' : '<span>ğŸŒ™</span>';
      }
      toggleSidebar(open) {
        const openBtn = document.querySelector('.open-sidebar-btn');
        if (open) {
          this.domElements.sidebar.classList.add('open');
          this.domElements.sidebarOverlay.classList.add('active');
          openBtn.setAttribute('aria-expanded', 'true');
          setTimeout(() => {
            const closeBtn = this.domElements.sidebar.querySelector('.close-sidebar-btn');
            if (closeBtn) {
              closeBtn.focus();
            }
          }, 100);
        } else {
          this.domElements.sidebar.classList.remove('open');
          this.domElements.sidebarOverlay.classList.remove('active');
          openBtn.setAttribute('aria-expanded', 'false');
          if (openBtn) {
            openBtn.focus();
          }
        }
      }
      showScreen(screenName) {
        if (document.activeElement) document.activeElement.blur();
        Object.values(this.domElements.screens).forEach(screen => {
          if (screen) {
            screen.classList.remove('active');
            screen.setAttribute('aria-hidden', 'true');
          }
        });
        const activeScreen = this.domElements.screens[screenName];
        if (activeScreen) {
          activeScreen.classList.add('active');
          activeScreen.setAttribute('aria-hidden', 'false');
          const firstFocusable = activeScreen.querySelector('button, [href], input, select, textarea');
          if (firstFocusable) firstFocusable.focus();
        }
      }
      hideLoader() {
        if (this.domElements.screens.loader) {
          this.domElements.screens.loader.classList.remove('active');
        }
      }
      showToast(message, type = 'info') {
        const toastContainer = document.getElementById('toast-container');
        if (!toastContainer) return;
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = message;
        toast.setAttribute('role', 'alert');
        toastContainer.appendChild(toast);
        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ù„Ù„Ø¸Ù‡ÙˆØ±
        toast.style.animation = 'toastIn 0.3s ease, toastOut 0.3s ease 2.7s forwards';
        setTimeout(() => toast.remove(), 3000);
      }
      async apiCall(payload) {
        try {
          const response = await fetch(this.API_URL, {
            method: 'POST',
            mode: 'cors',
            headers: {
              'Content-Type': 'text/plain;charset=utf-8'
            },
            body: JSON.stringify(payload)
          });
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          return await response.json();
        } catch (error) {
          console.error('API Error:', error);
          throw error;
        }
      }
      getDeviceId() {
        let id = localStorage.getItem('deviceId');
        if (!id) {
          id = `id_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
          localStorage.setItem('deviceId', id);
        }
        return id;
      }
      formatTime(totalSeconds) {
        const minutes = Math.floor(totalSeconds / 60);
        const seconds = Math.floor(totalSeconds % 60);
        if (minutes > 0) {
          return `${minutes} Ø¯Ù‚ÙŠÙ‚Ø© Ùˆ ${seconds} Ø«Ø§Ù†ÙŠØ©`;
        }
        return `${seconds} Ø«Ø§Ù†ÙŠØ©`;
      }
      formatNumber(num) {
        return new Intl.NumberFormat('ar-EG').format(num);
      }
      displayHelperCosts() {
        this.domElements.helperBtns.forEach(btn => {
          const type = btn.dataset.type;
          const cost = this.HELPER_COSTS[type];
          if (cost) {
            const costEl = btn.querySelector('.helper-cost');
            if (costEl) {
              costEl.textContent = `(-${cost})`;
            }
          }
        });
      }
      startCooldownTimer(cooldownEndTimeISO) {
        const cooldownEndTime = new Date(cooldownEndTimeISO);
        this.domElements.cooldownContainer.style.display = 'block';
        document.getElementById('startPlayBtn').disabled = true;
        const timerInterval = setInterval(() => {
          const now = new Date();
          const remainingTime = cooldownEndTime - now;
          if (remainingTime <= 0) {
            clearInterval(timerInterval);
            this.domElements.cooldownContainer.style.display = 'none';
            document.getElementById('startPlayBtn').disabled = false;
            return;
          }
          const hours = Math.floor((remainingTime / (1000 * 60 * 60)));
          const minutes = Math.floor((remainingTime / 1000 / 60) % 60);
          const seconds = Math.floor((remainingTime / 1000) % 60);
          this.domElements.cooldownTimer.textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }, 1000);
      }
      // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ø­Ø±ÙƒÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ±
      animateElements() {
        // ØªØ£Ø«ÙŠØ± Ù„Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ Ù„Ù„Ø¹Ù†Ø§ØµØ±
        const animateOnScroll = () => {
          const elements = document.querySelectorAll('.content-box, .btn, .avatar-option');
          elements.forEach(element => {
            const elementTop = element.getBoundingClientRect().top;
            const elementVisible = 150;
            if (elementTop < window.innerHeight - elementVisible) {
              element.style.opacity = "1";
              element.style.transform = "translateY(0)";
            }
          });
        };
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø£ÙˆÙ„ÙŠ
        const animatedElements = document.querySelectorAll('.content-box, .btn, .avatar-option');
        animatedElements.forEach(element => {
          element.style.opacity = "0";
          element.style.transform = "translateY(20px)";
          element.style.transition = "opacity 0.5s ease, transform 0.5s ease";
        });
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ±
        window.addEventListener("scroll", animateOnScroll);
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† ÙÙˆØ± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        setTimeout(animateOnScroll, 100);
      }
    }
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
      const game = new QuizGame();
      // Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          const activeModal = document.querySelector('.modal.active');
          if (activeModal) {
            game.toggleSidebar(false);
          }
        }
        // Ø¯Ø¹Ù… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (1-4)
        if (document.getElementById('gameContainer').classList.contains('active')) {
          const key = parseInt(e.key);
          if (key >= 1 && key <= 4) {
            const options = document.querySelectorAll('.option-btn:not(.disabled)');
            if (options.length >= key) {
              options[key - 1].click();
            }
          }
        }
      });
    });
    // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª CSS dynamically
    const style = document.createElement('style');
    style.textContent = `
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0, 0, 0); }
            40%, 43% { transform: translate3d(0, -15px, 0); }
            70% { transform: translate3d(0, -7px, 0); }
            90% { transform: translate3d(0, -3px, 0); }
        }
        
        .pulse { animation: pulse 2s infinite; }
        .bounce { animation: bounce 1s infinite; }
        
        .level-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        .level-easy { background-color: #2ec4b6; color: white; }
        .level-medium { background-color: #4361ee; color: white; }
        .level-hard { background-color: #ff9f1c; color: black; }
        .level-impossible { background-color: #e71d36; color: white; }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
